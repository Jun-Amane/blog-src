<!doctype html>
<html
  lang="en-us"
  dir="ltr"
>
   <script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>
<script>
  MathJax = {
    tex: {
      displayMath: [
        ["\\[", "\\]"],
        ["$$", "$$"],
      ], 
      inlineMath: [["\\(", "\\)"]], 
    },
    loader: {
      load: ["ui/safe"],
    },
  };
</script>
  <head>
  <meta charset="utf-8" />
  <title>
    ~Simple Chroot Implemention on Android~ - 無何有之鄉
  </title>
  <meta
    name="description"
    content="Jun Amaneの博客～技术与随笔的可爱小站~"
  />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Noto+Serif+SC:wght@600&family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="/css/out.css" type="text/css" />
  
  
  
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />

  
<link rel="stylesheet" href="/css/main.css" />
 
      <script src="/js/main.js"></script>

</head>

  <body class="bg-[#F8FBFF] text-gray-800 font-serif">
    
    
    <div class="flex min-h-screen max-w-screen-2xl mx-auto">
      
      <aside
  class="w-64 px-4 py-8 flex flex-col justify-between h-screen sticky top-0"
>
  
  <div class="space-y-6">
    <div>
      <h3 class="text-base tracking-wide mb-2 font-bold">
        <span class="font-serif text-my-ultramarine">zzy040330.</span
        ><span class="font-sans text-my-pink">萌え</span>
      </h3>

      <h1 class="text-4xl text-my-ultramarine tracking-wide mb-2 font-bold">
        無何有之鄉
      </h1>
      <p class="text-base text-gray-500 italic">~ Pursuing the Eternal ~</p>
    </div>

    <nav class="text-xl space-y-2 text-my-ultramarine font-medium">
      <a href="/" class="block hover:text-my-pink">首页</a>
      <a href="/categories/" class="block hover:text-my-pink">分类</a>
      <a href="/tags/" class="block hover:text-my-pink">标签</a>
      <a href="/posts/" class="block hover:text-my-pink">归档</a>
      <a href="/about/" class="block hover:text-my-pink">关于</a>
    </nav>

    <a
      href="/index.xml"
      class="block text-sm text-my-ultramarine hover:text-my-pink"
      ><i class="fa-solid fa-rss"></i> RSS 订阅
    </a>
    
    <div class="text-lg mt-6 border-t border-gray-200 pt-4 text-sm space-y-2">
      <a
        href="https://orcid.org/0000-0000-0000-0000"
        class="flex gap-2 text-my-ultramarine hover:text-my-pink"
      >
        <i class="fa-brands fa-orcid"></i> ORCID
      </a>
      <a
        href="https://www.researchgate.net/profile/Jun-Amane"
        class="flex gap-2 text-my-ultramarine hover:text-my-pink"
      >
        <i class="fa-brands fa-researchgate"></i> ResearchGate
      </a>
      <a
        href="https://github.com/Jun-Amane"
        class="flex gap-2 text-my-ultramarine hover:text-my-pink"
      >
        <i class="fa-brands fa-github"></i> GitHub
      </a>
      <a
        href="mailto:jun@university.edu"
        class="flex gap-2 text-my-ultramarine hover:text-my-pink"
      >
        <i class="fa-solid fa-envelope-circle-check"></i> 学术邮箱
      </a>
      <a
        href="mailto:Jun.Amane@zzy040330.moe"
        class="flex gap-2 text-my-ultramarine hover:text-my-pink"
      >
        <i class="fa-solid fa-envelope"></i> 个人邮箱
      </a>
    </div>
  </div>

  
  <footer class="text-xs text-gray-400 pt-6 border-t border-gray-200 mt-12">
    <p class="leading-relaxed">
      © 2013-2025 無何有之鄉 <br />
      <a href="https://creativecommons.org/licenses/by-sa/4.0/"
        >本站採用 CC BY-SA 4.0 許可證</a
      ><br />
      Designed by Jun & A.L.I.C.E.
    </p>
  </footer>
</aside>


      
      <main class="flex-1 px-6 py-12">
<article class="max-w-3xl mx-auto text-base leading-relaxed">
  <header class="mb-10">
    <p class="text-sm text-gray-500">2022-07-29 07:56</p>
    <h1 class="text-4xl font-bold text-my-ultramarine tracking-tight my-2">
      ~Simple Chroot Implemention on Android~
    </h1>
    
    <hr class="mt-4 border-[#a0c4ff]" />
  </header>

  <div class="prose prose-indigo max-w-none"><h3>准备</h3>
<ul>
<li>Android固件等（若系统运行正常则无需此项）</li>
<li>拥有一定的Linux系统操作能力</li>
<li>对Android系统有一定了解</li>
<li><a href="https://github.com/topjohnwu/Magisk/releases">Magisk安装包</a></li>
<li><a href="https://github.com/meefik/linuxdeploy/releases">LinuxDeploy安装包</a></li>
<li>适用于设备的TWRP Recovery镜像
<br/></li>
</ul>
<h3>恢复Android系统（若系统运行正常则跳过）</h3><br/>
以Arch Linux演示。<br/>
&emsp;&emsp;采用高通EDL模式恢复，在PC上通过git命令克隆qdl仓库：
<p><code>git clone git@github.com:andersson/qdl.git</code></p>
<br/>
&emsp;&emsp;并使用make编译。然后使用qdl：
<p><code>sudo ./qdl --include prog_emmc_firehose_8953_ddr.mbn rawprogram_unsparse_upgrade.xml patch0.xml</code><br/>
  此时断开设备电源，同时短接如图所示两触点，并插入连接线，使设备进入EDL模式并恢复。</p>
<p><img src="testpoint.jpeg" alt="testpoint"><br /></p>
<p><img src="qdl.png" alt="qdl"><br /></p>
<h3>安装TWRP-Recovery并载入root</h3><br/>
&emsp;&emsp;重启设备至fastboot模式，使用如下命令安装TWRP（安装分区按需调整，如华为设备等将内核与ramdisk拆分的设备可能为recovery_ramdisk）
<p><code>fastboot flash recovery recovery.img</code><br/>
然后重启进入recovery模式。</p>
<p><img src="fastboot.png" alt="fastboot"><br />
  通过mtp功能或传输介质将Magisk安装包下载到设备中，并重命名apk为zip（新版的Magisk将apk与twrp用zip合二为一）。再通过twrp安装Magisk，随后重启进去android系统，安装对应的apk，root权限获取。</p>
<p><img src="twrp.png" alt="twrp"><br /></p>
<h3>安装Linux系统</h3><br/>
&emsp;&emsp;安装LinuxDeploy应用程式并进入右上角设置选项。按照需要进行设置，在此选择Kali Linux发行版，由于Kali Linux同Arch Linux一样为滚动更新，与Ubuntu等不同，故可以时刻使操作系统保持最新，而其中Ubuntu仅支持到Ubuntu Bionic，无法获取最新版本（最新版本安装时需要用到zstd等工具）。故此处安装Kali Linux。<br/>
&emsp;&emsp;在设置中，将"Souce Path"更改为本地化的镜像源可以显著提高安装速度。另，“Installation Type”可按需选择，此处选择"Directory"，即安装到本地目录，需要注意的是，该目录"Install Path"需要ext4文件系统，并支持权限更改，故/sdcard中不可安装，而/data/local/是一个很好的选择。<br/>
<p><img src="source.png" alt="source"><br />
  往下“Username”与“Password”、“Localization”按需更改。注意“MOUNTS”选项，意为挂载，可将android文件系统挂载至Linux中，勾选“Enable”，进入“Mount Points”中，此处习惯性地将/sdcard/挂载入Linux中的/sdcard/，方便传输数据。<br/></p>
<p><img src="mounts.png" alt="mounts"><br />
  再往下，ssh与GUI可按需启用，GUI中可以将桌面环境更换为自己习惯使用的，此处选择Xfce。
设置完成后，返回主界面，点击右上角选项中的“Install”，并授予root权限，开始安装。<br/></p>
<p><img src="gui.png" alt="gui">
<br /></p>
<p><img src="settings1.png" alt="settings1">
<br /></p>
<p><img src="settings2.png" alt="settings2">
<br /></p>
<p><img src="settings3.png" alt="settings3">
<br /></p>
<p><img src="install.png" alt="install">
<br /></p>
<p><img src="installLog.png" alt="installLog">
<br /></p>
<p><img src="installComplete.png" alt="installComplete">
<br />
<br/></p>
<h3>必要的设置</h3><br/>
&emsp;&emsp;安装完成后，点击右上角Start挂载并运行Linux。<br/>
<p><img src="start.png" alt="start"><br />
  使用ssh访问该设备，并用密码登录。此时，默认shell为sh，须更换为bash方便操作，使用</p>
<p><code>chsh</code><br/>
并按需操作即可。莫忘修改root密码。<br />
<img src="ssh.png" alt="ssh">
<br />
<img src="bash.png" alt="bash">
<br />
<img src="root.png" alt="root">
<br />
  同样，使用VNC客户端可访问到该设备。<br /></p>
<p><img src="vnc.png" alt="vnc">
<br /></p>
<br />
<br />
<p><i>Jun ASAKA</i>
<br />
<i>二〇二二年七月初一 金曜日</i></p>
<!--more--></div>

  
<div class="mt-8 flex flex-wrap gap-2 text-sm">
  <a
    href="/tags/embedded-system/"
    class="px-3 py-1 rounded-full bg-my-ultramarine/10 text-my-ultramarine hover:bg-my-ultramarine/20 transition"
  >
    #Embedded System
  </a>
  <a
    href="/tags/android/"
    class="px-3 py-1 rounded-full bg-my-ultramarine/10 text-my-ultramarine hover:bg-my-ultramarine/20 transition"
  >
    #Android
  </a>
  <a
    href="/tags/flashing/"
    class="px-3 py-1 rounded-full bg-my-ultramarine/10 text-my-ultramarine hover:bg-my-ultramarine/20 transition"
  >
    #Flashing
  </a>
  <a
    href="/tags/chroot/"
    class="px-3 py-1 rounded-full bg-my-ultramarine/10 text-my-ultramarine hover:bg-my-ultramarine/20 transition"
  >
    #Chroot
  </a>
</div>

</article>
</main>
    </div>
  </body>
</html>
